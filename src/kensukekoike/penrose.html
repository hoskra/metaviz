<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="canvas">
  <meta name="author" content="hoskra">
  <script src="../libs/three.js" defer></script>
	<script src="../util/penroseUtils.js" defer></script>
  <title>Penrose</title>
  <style>
    body { margin: 0; }
  </style>
</head>

<script type="module">

const camera = new THREE.PerspectiveCamera( 100, window.innerWidth / window.innerHeight, 0.01, 20 );
camera.position.z = 1;
let mouse = {x:0, y:0};

const imgName = '../img/2.jpg';

function addMesh(geometry, material) {
  const mesh = new THREE.Mesh(geometry, material);
  scene.add(mesh);
  return mesh;
}

const scene = new THREE.Scene();
const renderer = new THREE.WebGLRenderer( { antialias: true } );
renderer.setSize( window.innerWidth, window.innerHeight );
renderer.setAnimationLoop( animation );
document.body.appendChild( renderer.domElement );

const geometry = new THREE.BoxGeometry(2,2,1 );
const texture = new THREE.TextureLoader().load( imgName );
let textureMat = new THREE.MeshBasicMaterial( { map: texture } );

let a = addMesh(geometry, textureMat);
a.position.z = -0.5;


const texture1 = new THREE.TextureLoader().load( imgName );
texture1.offset = new THREE.Vector2(0.506350550381033,0.506350550381033)
let textureMat1 = new THREE.MeshBasicMaterial( { map: texture1 } );

const greenMat = new THREE.MeshBasicMaterial({color: 0x00ff00,side: THREE.DoubleSide,});
const blueMat = new THREE.MeshBasicMaterial({color: 0x0000ff,side: THREE.DoubleSide,});
const redMat = new THREE.MeshBasicMaterial({color: 0xff0000,side: THREE.DoubleSide,});


const texture11 = new THREE.TextureLoader().load( imgName );
texture11.offset = new THREE.Vector2(0.506350550381033,0.506350550381033)
let textureMat11 = new THREE.MeshBasicMaterial( { map: texture11 } );
let geomShape1 = new THREE.ShapeBufferGeometry(new THREE.Shape(gg));
// let ggPenrose = addMesh(geomShape1,  greenMat);
let ggPenrose = addMesh(geomShape1,  textureMat11);

const texture22 = new THREE.TextureLoader().load( imgName );
texture22.offset = new THREE.Vector2(0.506350550381033,0.506350550381033)
let textureMat22 = new THREE.MeshBasicMaterial( { map: texture22 } );
let geomShape2 = new THREE.ShapeBufferGeometry(new THREE.Shape(bb));
// let bbPenrose = addMesh(geomShape2,  blueMat);
let bbPenrose = addMesh(geomShape2,  textureMat22);


const texture33 = new THREE.TextureLoader().load( imgName );
texture33.offset = new THREE.Vector2(0.506350550381033,0.506350550381033)
let textureMat33 = new THREE.MeshBasicMaterial( { map: texture33 } );
let geomShape3 = new THREE.ShapeBufferGeometry(new THREE.Shape(rr));
// let rrPenrose = addMesh(geomShape3,  redMat);
let rrPenrose = addMesh(geomShape3,  textureMat33);


rrPenrose.position.x += -0.07
rrPenrose.position.y += 0.05
rrPenrose.rotation.z = 120 * 0.00872665;

bbPenrose.rotation.z = 360 * 0.00872665;
bbPenrose.position.x += - 0.081;
bbPenrose.position.y += - 0.037;

ggPenrose.rotation.z = - 120 * 0.00872665;

// create threejs group
const group = new THREE.Group();
group.add(rrPenrose);
group.add(bbPenrose);
group.add(ggPenrose);

scene.add(group);

// scale object
const scale = 1.5;
group.scale.set(scale, scale, scale);

group.position.x += 0.1;

console.log(texture11.offset.x)
console.log(texture22.offset.y)
console.log(texture33.offset.x)
0.506350550381033
0.506350550381033
0.506350550381033
function animation( time ) {

	texture11.offset.x += 0;
	texture22.offset.y += 0;
	texture33.offset.x -= 0;
	// texture11.offset.x += Math.cos(time/1000)/500
	// texture22.offset.y += Math.cos(time/1000)/500
	// texture33.offset.x -= Math.cos(time/1000)/500

	// group.rotation.z =  time/1000;
  // group.position.z = Math.cos(time/1000)/5 + 0.2

	renderer.render( scene, camera );

}

document.addEventListener('mousemove', onDocumentMouseMove, false);

function onDocumentMouseMove(event) {
  event.preventDefault();
  mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
  mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;

  texture11.offset.x = 0.506350550381033 + Math.cos(mouse.x-mouse.y/2) * 0.2;
	texture22.offset.y = 0.506350550381033 + Math.cos(mouse.y+mouse.x/2)* 0.2;
	texture33.offset.x = 0.506350550381033 - Math.cos(mouse.x+mouse.y/2)* 0.2;
}

window.addEventListener( 'resize', onWindowResize, false );

function onWindowResize(){
  camera.aspect = window.innerWidth / window.innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize( window.innerWidth, window.innerHeight );
}

</script>
</html>